pico-8 cartridge // http://www.pico-8.com
version 26
__lua__
--classic snake	
function _init()
	game_over=false
	score=0
	speed=10
	make_player()
	drop_fruit()
	music(0)
end

function _update()
	if not game_over then 
		move_player()
	else
		if (btnp(❎)) _init()
	end
end

function _draw()
	cls()
	map()
	draw_player()
	draw_fruit()
	print("score:"..score,10,1,7)
	if (game_over) print("play again? ❎",63,1,7)
end

-->8
--player
function make_player()
	body={
		{5,8},
		{6,8},
		{7,8},
	}
	headx=body[#body][1]
	heady=body[#body][2]
	
	pdir=1 --0=⬅️ 1=➡️ 2=⬆️ 3=⬇️
	
	move_timer=speed
end

function move_player()	
	if (btnp(⬅️))	pdir=0
	if (btnp(➡️))	pdir=1
	if (btnp(⬆️))	pdir=2
	if (btnp(⬇️))	pdir=3
	
	if move_timer<0 then
		if (pdir==0) headx-=1
		if (pdir==1) headx+=1
		if (pdir==2) heady-=1
		if (pdir==3) heady+=1
		
		if (headx<0)  headx=15
		if (headx>15) headx=0
		if (heady<1)  heady=15
		if (heady>15) heady=1
		
		add(body,{headx,heady})
		
		check_hit()
		
		move_timer=speed
	end
	move_timer-=1
end

function check_hit()
	if headx==fruitx and heady==fruity then
		score+=5
		if (speed>2) speed-=1
		sfx(0)
		drop_fruit()
	else
		sfx(1)
		del(body,body[1])
	end

	if mget(headx,heady)==17 then
			game_over=true
	end

	if not game_over then
		for i=1,#body-1 do
			local seg=body[i]
			local x,y=seg[1],seg[2]
			--collision with body
			if x==headx and y==heady then
				game_over=true
				break
			end
		end
	end
	
	if game_over then
		music(-1)
		sfx(4)
	end
end

function draw_player()
	for seg in all(body) do
		local x,y=seg[1],seg[2]
		local si=(x==headx and y==heady) and 1 or 2
		spr(si,x*8,y*8)
	end
	if (game_over) spr(3,headx*8,heady*8)
end
-->8
--fruit
function drop_fruit()
	local valid_spot=false
	while not valid_spot do
		fruitx=flr(rnd(15))
		fruity=flr(rnd(15))
				
		if mget(fruitx,fruity)==16 then --grass
			valid_spot=true
			for seg in all(body) do
					if fruitx==seg[1] and fruity==seg[2] then
							valid_spot=false
							break
					end
			end
		end
	end
end

function draw_fruit()
	spr(18,fruitx*8,fruity*8)
end
__gfx__
00000000009aa70000a7a70000755500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000009aaaa700499997007555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007009a1aa1a74999999a75655565000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770009aaaaaaa4999999776665666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770009a1111aa4999999a75655565000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007009aa111aa4999999775555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000009aaaaa0049999a007555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000009999000044440000777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333377777733333333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333766666653333bb3300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3343333376666665332b883300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
333333337666666532888e8300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333766666653288888300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333343766666653328883300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333433766666653332233300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
33333333355555533333333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
1100000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1111111111111110101111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1110101010101010101010101010101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1110101010101010101010101010101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1110101111101010101010111110101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1110101111101010101010111110101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1110101010101010101010101010101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1010101010101010101010101010101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1110101010101010101010101010101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1110101010101010101010101010101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1110101111101010101010111110101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1110101111101010101010111110101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1110101010101010101010101010101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1110101010101010101010101010101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1111111111111110101111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000500000a02106031090410d051130511c0612a071310711f0012700133001380013a001370011d0010000100001000010000100001000010000100001000010000100001000010000100001000010000100001
000100002573019000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00100000267351b0051773525105217350e0050b73516305227351c705267352c0352800520735000051573500005087350000522735000051773513735000050b735000052273500005267352b035000051d735
001000000b0020f0520000207052000020c052000021005200002070520f0020c052000020f0520000207052000020c052000021005200002070520000210052000020a052000020505200002100520000209052
010800001f7512a751000011a751207511c7010d05117051000010a0510e051000010605109051000010415103151021510115100151000010000100001000010000100001000010000100001000010000100001
__music__
02 02034344

